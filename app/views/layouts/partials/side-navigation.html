{% set buildingPages = data.buildingPages %}
{% set standardsPages = data.standardsPages %}
{% set usingPages = data.usingPages %}

{% from "./../macros/nav-list-item.njk" import verticalNavListItem %}
<style>
    <style>
    .app-vertical-nav__link:focus,
    .app-vertical-nav__link:focus-visible {
        border-color: #0b0c0c;
        outline: none;
        color: #0b0c0c;
        background-color: #fd0;
        box-shadow: none;
    }
</style>

    </style>
<div id="sidebar" class="app-layout__sidebar">

    <moj-collapsible-nav open-class="app-vertical-nav__item--open" id="building-nav">
        <nav class="app-vertical-nav" aria-labelledby="building-nav-title">
            <h2 class="app-vertical-nav__header" id="building-nav-title">Building blocks</h2>
            <ul class="app-vertical-nav__list">

                <li class="app-vertical-nav__item app-vertical-nav__item--with-children">
                    <button aria-controls="building-nav-collapsible-nav-0" aria-expanded="false" class="app-vertical-nav__toggle">Components<div class="app-vertical-nav__indicator">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd" clip-rule="evenodd" d="M11.9999 10.5177L17.7928 16.3105L19.207 14.8963L11.9999 7.68923L4.79282 14.8963L6.20703 16.3105L11.9999 10.5177Z" fill="currentColor"></path>
                            </svg>
                        </div>
                    </button>
                    <ul class="app-vertical-nav__list" id="building-nav-collapsible-nav-0" hidden="">

                        <li class="app-vertical-nav__item   app-vertical-nav__item--with-children">
                            <a class="app-vertical-nav__link" href="/components/add-another">Add another</a>
                        </li>

                        <li class="app-vertical-nav__item   app-vertical-nav__item--with-children">
                            <a class="app-vertical-nav__link" href="/components/badge">Badge</a>
                        </li>

                        <li class="app-vertical-nav__item   app-vertical-nav__item--with-children">
                            <a class="app-vertical-nav__link" href="/components/banner">Banner</a>
                        </li>

                        <li class="app-vertical-nav__item   app-vertical-nav__item--with-children">
                            <a class="app-vertical-nav__link" href="/components/button-menu">Button menu</a>
                        </li>

                        <li class="app-vertical-nav__item   app-vertical-nav__item--with-children">
                            <a class="app-vertical-nav__link" href="/components/date-picker">Date picker</a>
                        </li>

                        <li class="app-vertical-nav__item   app-vertical-nav__item--with-children">
                            <a class="app-vertical-nav__link" href="/components/filter">Filter</a>
                        </li>

                        <li class="app-vertical-nav__item   app-vertical-nav__item--with-children">
                            <a class="app-vertical-nav__link" href="/components/header">Header</a>
                        </li>

                        <li class="app-vertical-nav__item   app-vertical-nav__item--with-children">
                            <a class="app-vertical-nav__link" href="/components/identity-bar">Identity bar</a>
                        </li>

                        <li class="app-vertical-nav__item   app-vertical-nav__item--with-children">
                            <a class="app-vertical-nav__link" href="/components/interruption-card">Interruption card</a>
                        </li>

                        {% if data['add-component'] == "complete" %}
                        <li class="app-vertical-nav__item   app-vertical-nav__item--with-children">
                            <a class="app-vertical-nav__link" href="/components/loading-spinner">Loading spinner</a>
                        </li>
                        {% endif %} 

                        <li class="app-vertical-nav__item   app-vertical-nav__item--with-children">
                            <a class="app-vertical-nav__link" href="/components/messages">Messages</a>
                        </li>

                        <li class="app-vertical-nav__item   app-vertical-nav__item--with-children">
                            <a class="app-vertical-nav__link" href="/components/multi-file-upload">Multi file upload</a>
                        </li>

                        <li class="app-vertical-nav__item   app-vertical-nav__item--with-children">
                            <a class="app-vertical-nav__link" href="/components/multi-select">Multi select</a>
                        </li>

                        <li class="app-vertical-nav__item   app-vertical-nav__item--with-children">
                            <a class="app-vertical-nav__link" href="/components/notification-badge">Notification badge</a>
                        </li>

                        <li class="app-vertical-nav__item   app-vertical-nav__item--with-children">
                            <a class="app-vertical-nav__link" href="/components/organisation-switcher">Organisation switcher</a>
                        </li>

                        <li class="app-vertical-nav__item   app-vertical-nav__item--with-children">
                            <a class="app-vertical-nav__link" href="/components/page-header-actions">Page header actions</a>
                        </li>

                        <li class="app-vertical-nav__item   app-vertical-nav__item--with-children">
                            <a class="app-vertical-nav__link" href="/components/pagination">Pagination</a>
                        </li>

                        <li class="app-vertical-nav__item   app-vertical-nav__item--with-children">
                            <a class="app-vertical-nav__link" href="/components/primary-navigation">Primary navigation</a>
                        </li>

                        <li class="app-vertical-nav__item   app-vertical-nav__item--with-children">
                            <a class="app-vertical-nav__link" href="/components/scrollable-pane">Scrollable pane</a>
                        </li>

                        <li class="app-vertical-nav__item   app-vertical-nav__item--with-children">
                            <a class="app-vertical-nav__link" href="/components/search">Search</a>
                        </li>

                        <li class="app-vertical-nav__item   app-vertical-nav__item--with-children">
                            <a class="app-vertical-nav__link" href="/components/side-navigation">Side navigation</a>
                        </li>

                        <li class="app-vertical-nav__item   app-vertical-nav__item--with-children">
                            <a class="app-vertical-nav__link" href="/components/sortable-table">Sortable table</a>
                        </li>

                        <li class="app-vertical-nav__item   app-vertical-nav__item--with-children">
                            <a class="app-vertical-nav__link" href="/components/sub-navigation">Sub navigation</a>
                        </li>

                        <li class="app-vertical-nav__item   app-vertical-nav__item--with-children">
                            <a class="app-vertical-nav__link" href="/components/ticket-panel">Ticket panel</a>
                        </li>

                        <li class="app-vertical-nav__item   app-vertical-nav__item--with-children">
                            <a class="app-vertical-nav__link" href="/components/timeline">Timeline</a>
                        </li>
                    </ul>
                </li>

                <li class="app-vertical-nav__item app-vertical-nav__item--with-children">
                    <button aria-controls="building-nav-collapsible-nav-1" aria-expanded="false" class="app-vertical-nav__toggle">Patterns<div class="app-vertical-nav__indicator">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd" clip-rule="evenodd" d="M11.9999 10.5177L17.7928 16.3105L19.207 14.8963L11.9999 7.68923L4.79282 14.8963L6.20703 16.3105L11.9999 10.5177Z" fill="currentColor"></path>
                            </svg>
                        </div>
                    </button>
                    <ul class="app-vertical-nav__list" hidden="" id="building-nav-collapsible-nav-1">

                        <li class="app-vertical-nav__item   app-vertical-nav__item--with-children">
                            <a class="app-vertical-nav__link" href="/patterns/add-to-a-list/">Add to a list</a>
                        </li>

                        <li class="app-vertical-nav__item   app-vertical-nav__item--with-children">
                            <a class="app-vertical-nav__link" href="/patterns/filter-a-list/">Filter a list</a>
                        </li>

                        <li class="app-vertical-nav__item   app-vertical-nav__item--with-children">
                            <a class="app-vertical-nav__link" href="/patterns/get-help/">Get help</a>
                        </li>

                        <li class="app-vertical-nav__item   app-vertical-nav__item--with-children">
                            <a class="app-vertical-nav__link" href="/patterns/upload-files/">Upload files</a>
                        </li>
                    </ul>
                </li>

                <li class="app-vertical-nav__item app-vertical-nav__item--with-children">
                    <button aria-controls="building-nav-collapsible-nav-2" aria-expanded="false" class="app-vertical-nav__toggle">Pages<div class="app-vertical-nav__indicator">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd" clip-rule="evenodd" d="M11.9999 10.5177L17.7928 16.3105L19.207 14.8963L11.9999 7.68923L4.79282 14.8963L6.20703 16.3105L11.9999 10.5177Z" fill="currentColor"></path>
                            </svg>
                        </div>
                    </button>
                    <ul class="app-vertical-nav__list" hidden="" id="building-nav-collapsible-nav-2">

                        <li class="app-vertical-nav__item   app-vertical-nav__item--with-children">
                            <a class="app-vertical-nav__link" href="/pages/case-list/">Case list page</a>
                        </li>
                    </ul>
                </li>

                <li class="app-vertical-nav__item app-vertical-nav__item--with-children">
                    <button aria-controls="building-nav-collapsible-nav-3" aria-expanded="false" class="app-vertical-nav__toggle">Archive<div class="app-vertical-nav__indicator">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd" clip-rule="evenodd" d="M11.9999 10.5177L17.7928 16.3105L19.207 14.8963L11.9999 7.68923L4.79282 14.8963L6.20703 16.3105L11.9999 10.5177Z" fill="currentColor"></path>
                            </svg>
                        </div>
                    </button>
                    <ul class="app-vertical-nav__list" hidden="" id="building-nav-collapsible-nav-3">

                        <li class="app-vertical-nav__item   app-vertical-nav__item--with-children">
                            <a class="app-vertical-nav__link" href="/archive/currency-input/">Currency input</a>
                        </li>

                        <li class="app-vertical-nav__item   app-vertical-nav__item--with-children">
                            <a class="app-vertical-nav__link" href="/archive/form-validator/">Form validator</a>
                        </li>

                        <li class="app-vertical-nav__item   app-vertical-nav__item--with-children">
                            <a class="app-vertical-nav__link" href="/archive/password-reveal/">Password reveal</a>
                        </li>

                        <li class="app-vertical-nav__item   app-vertical-nav__item--with-children">
                            <a class="app-vertical-nav__link" href="/archive/question-pages/">Question page</a>
                        </li>

                        <li class="app-vertical-nav__item   app-vertical-nav__item--with-children">
                            <a class="app-vertical-nav__link" href="/archive/rich-text-editor/">Rich text editor</a>
                        </li>

                        <li class="app-vertical-nav__item   app-vertical-nav__item--with-children">
                            <a class="app-vertical-nav__link" href="/archive/tag/">Tag</a>
                        </li>

                        <li class="app-vertical-nav__item   app-vertical-nav__item--with-children">
                            <a class="app-vertical-nav__link" href="/archive/task-list/">Task list page</a>
                        </li>
                    </ul>
                </li>
{#
                <li class="app-vertical-nav__item app-vertical-nav__item--with-children">
                    <button aria-controls="building-nav-collapsible-nav-3" aria-expanded="false" class="app-vertical-nav__toggle">Community components<div class="app-vertical-nav__indicator">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd" clip-rule="evenodd" d="M11.9999 10.5177L17.7928 16.3105L19.207 14.8963L11.9999 7.68923L4.79282 14.8963L6.20703 16.3105L11.9999 10.5177Z" fill="currentColor"></path>
                            </svg>
                        </div>
                    </button>
                    <ul class="app-vertical-nav__list" hidden="" id="building-nav-collapsible-nav-3">
                        <li class="app-vertical-nav__item   app-vertical-nav__item--with-children">
                            <a class="app-vertical-nav__link" href="/community-components/spinner">Spinner</a>
                        </li>
                    </ul>
                </li>
                #}
            </ul>
        </nav>
    </moj-collapsible-nav>

    <moj-collapsible-nav open-class="app-vertical-nav__item--open" id="standards-nav">
        <nav class="app-vertical-nav" aria-labelledby="standards-nav-title">
            <h2 class="app-vertical-nav__header" id="standards-nav-title">Standards and principles</h2>
            <ul class="app-vertical-nav__list">

                <li class="app-vertical-nav__item app-vertical-nav__item--with-children">
                    <button aria-controls="standards-nav-collapsible-nav-0" aria-expanded="false" class="app-vertical-nav__toggle">Ethics<div class="app-vertical-nav__indicator">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd" clip-rule="evenodd" d="M11.9999 10.5177L17.7928 16.3105L19.207 14.8963L11.9999 7.68923L4.79282 14.8963L6.20703 16.3105L11.9999 10.5177Z" fill="currentColor"></path>
                            </svg>
                        </div>
                    </button>
                    <ul class="app-vertical-nav__list" id="standards-nav-collapsible-nav-0" hidden="">

                        <li class="app-vertical-nav__item   app-vertical-nav__item--with-children">
                            <a class="app-vertical-nav__link" href="/ethics/design-ethical-services/">Designing ethical services</a>
                        </li>

                        <li class="app-vertical-nav__item   app-vertical-nav__item--with-children">
                            <a class="app-vertical-nav__link" href="/ethics/principles/">Ethical principles</a>
                        </li>

                        <li class="app-vertical-nav__item   app-vertical-nav__item--with-children">
                            <a class="app-vertical-nav__link" href="/ethics/review/">Doing an ethics review</a>
                        </li>

                        <li class="app-vertical-nav__item   app-vertical-nav__item--with-children">
                            <a class="app-vertical-nav__link" href="/ethics/assessment/">Preparing for a service assessment</a>
                        </li>
                    </ul>
                </li>

                <li class="app-vertical-nav__item app-vertical-nav__item--with-children">
                    <button aria-controls="standards-nav-collapsible-nav-1" aria-expanded="false" class="app-vertical-nav__toggle">Content standards<div class="app-vertical-nav__indicator">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd" clip-rule="evenodd" d="M11.9999 10.5177L17.7928 16.3105L19.207 14.8963L11.9999 7.68923L4.79282 14.8963L6.20703 16.3105L11.9999 10.5177Z" fill="currentColor"></path>
                            </svg>
                        </div>
                    </button>
                    <ul class="app-vertical-nav__list" hidden="" id="standards-nav-collapsible-nav-1">

                        <li class="app-vertical-nav__item   app-vertical-nav__item--with-children">
                            <a class="app-vertical-nav__link" href="/content-standards/style-guide/">Content style guide</a>
                        </li>
                    </ul>
                </li>
            </ul>
        </nav>
    </moj-collapsible-nav>

    <moj-collapsible-nav open-class="app-vertical-nav__item--open" id="community-nav">
        <nav class="app-vertical-nav" aria-labelledby="community-nav-title">
            <h2 class="app-vertical-nav__header" id="community-nav-title">Community</h2>
            <ul class="app-vertical-nav__list">

                <li class="app-vertical-nav__item app-vertical-nav__item--with-children">
                    <button aria-controls="community-nav-collapsible-nav-0" aria-expanded="false" class="app-vertical-nav__toggle">Get involved<div class="app-vertical-nav__indicator">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd" clip-rule="evenodd" d="M11.9999 10.5177L17.7928 16.3105L19.207 14.8963L11.9999 7.68923L4.79282 14.8963L6.20703 16.3105L11.9999 10.5177Z" fill="currentColor"></path>
                            </svg>
                        </div>
                    </button>
                    <ul class="app-vertical-nav__list" id="standards-nav-collapsible-nav-0" hidden="">

                        <li class="app-vertical-nav__item   app-vertical-nav__item--with-children">
                            <a class="app-vertical-nav__link" href="/community/collaborate-with-the-community">Collaborate with the community</a>
                        </li>

                        <li class="app-vertical-nav__item   app-vertical-nav__item--with-children">
                            <a class="app-vertical-nav__link" href="/community/submit-new-component">Submit new component</a>
                        </li>

                        <li class="app-vertical-nav__item   app-vertical-nav__item--with-children">
                            <a class="app-vertical-nav__link" href="/community/add-to-an-existing-component">Add to an existing component</a>
                        </li>
                    </ul>
                </li>
            </ul>
        </nav>
    </moj-collapsible-nav>

    <moj-collapsible-nav open-class="app-vertical-nav__item--open" id="using-nav">
        <nav class="app-vertical-nav" aria-labelledby="using-nav-title">
            <h2 class="app-vertical-nav__header" id="using-nav-title">Using the design system</h2>
            <ul class="app-vertical-nav__list">

                <li class="app-vertical-nav__item app-vertical-nav__item--with-children">
                    <button aria-controls="using-nav-collapsible-nav-0" aria-expanded="false" class="app-vertical-nav__toggle">Prototyping<div class="app-vertical-nav__indicator">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd" clip-rule="evenodd" d="M11.9999 10.5177L17.7928 16.3105L19.207 14.8963L11.9999 7.68923L4.79282 14.8963L6.20703 16.3105L11.9999 10.5177Z" fill="currentColor"></path>
                            </svg>
                        </div>
                    </button>
                    <ul class="app-vertical-nav__list" hidden="" id="using-nav-collapsible-nav-0">

                        <li class="app-vertical-nav__item   app-vertical-nav__item--with-children">
                            <a class="app-vertical-nav__link" href="/prototyping/setting-up-figma-prototypes">Setting up Figma prototypes</a>
                        </li>

                        <li class="app-vertical-nav__item   app-vertical-nav__item--with-children">
                            <a class="app-vertical-nav__link" href="/prototyping/setting-up-coded-prototypes">Setting up coded prototypes</a>
                        </li>

                        <li class="app-vertical-nav__item   app-vertical-nav__item--with-children">
                            <a class="app-vertical-nav__link" href="/prototyping/deploying-coded-prototypes">Deploying coded prototypes</a>
                        </li>
                    </ul>
                </li>

                <li class="app-vertical-nav__item app-vertical-nav__item--with-children">
                    <button aria-controls="using-nav-collapsible-nav-1" aria-expanded="false" class="app-vertical-nav__toggle">Setup for production<div class="app-vertical-nav__indicator">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd" clip-rule="evenodd" d="M11.9999 10.5177L17.7928 16.3105L19.207 14.8963L11.9999 7.68923L4.79282 14.8963L6.20703 16.3105L11.9999 10.5177Z" fill="currentColor"></path>
                            </svg>
                        </div>
                    </button>
                    <ul class="app-vertical-nav__list" hidden="" id="using-nav-collapsible-nav-1">

                        <li class="app-vertical-nav__item   app-vertical-nav__item--with-children">
                            <a class="app-vertical-nav__link" href="/production/install-moj-frontend">Install MoJ Frontend</a>
                        </li>

                        <li class="app-vertical-nav__item   app-vertical-nav__item--with-children">
                            <a class="app-vertical-nav__link" href="/production/installing-with-npm">Install with npm</a>
                        </li>

                        <li class="app-vertical-nav__item   app-vertical-nav__item--with-children">
                            <a class="app-vertical-nav__link" href="/production/installing-compiled">Install with compiled files</a>
                        </li>

                        <li class="app-vertical-nav__item   app-vertical-nav__item--with-children">
                            <a class="app-vertical-nav__link" href="/production/setting-up-javascript">Setting up JavaScript</a>
                        </li>
                    </ul>
                </li>

                <li class="app-vertical-nav__item app-vertical-nav__item--with-children">
                    <button aria-controls="using-nav-collapsible-nav-2" aria-expanded="false" class="app-vertical-nav__toggle">Get involved<div class="app-vertical-nav__indicator">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd" clip-rule="evenodd" d="M11.9999 10.5177L17.7928 16.3105L19.207 14.8963L11.9999 7.68923L4.79282 14.8963L6.20703 16.3105L11.9999 10.5177Z" fill="currentColor"></path>
                            </svg>
                        </div>
                    </button>
                    <ul class="app-vertical-nav__list" hidden="" id="using-nav-collapsible-nav-2">

                        <li class="app-vertical-nav__item   app-vertical-nav__item--with-children">
                            <a class="app-vertical-nav__link" href="/get-involved/contribute">Propose a new component or pattern</a>
                        </li>

                        <li class="app-vertical-nav__item   app-vertical-nav__item--with-children">
                            <a class="app-vertical-nav__link" href="/get-involved/criteria">Contribution criteria</a>
                        </li>

                        <li class="app-vertical-nav__item   app-vertical-nav__item--with-children">
                            <a class="app-vertical-nav__link" href="/get-involved/suggest-a-change">Suggest a change or give feedback</a>
                        </li>
                    </ul>
                </li>

                <li class="app-vertical-nav__item   app-vertical-nav__item--with-children">
                    <a class="app-vertical-nav__link" href="/help/">Get help</a>
                </li>
            </ul>
        </nav>
    </moj-collapsible-nav>

</div>

<script>

    document.addEventListener("DOMContentLoaded", function () {
        console.log("Example page has loaded!");
        var list = document.getElementsByClassName("app-vertical-nav__item app-vertical-nav__item--with-children");

        // get a list of all the button elements that are in the side navigation
        var buttons = document.getElementsByClassName("app-vertical-nav__toggle");

        // get the url for the page, if the page is a sub page then open the menu for that section
        var url = document.location.href;
        console.log("Current URL:", url);

        // split up the url and grab the first and second parameters
        var urlParts = url.split("/");
        console.log("URL Parts:", urlParts);

        if (urlParts.length > 4) {
            var firstParam = urlParts[3].toLowerCase();
            var secondParam = urlParts[4].toLowerCase();

            // replace the - with a space
            firstParam = firstParam.split("-").join(" ");
            secondParam = secondParam.split("-").join(" ");
            console.log("First Param:", firstParam);
            console.log("Second Param:", secondParam);

            // cycle through the button list and check if the inner text matches the first parameter and if it does then open the menu
            for (var i = 0; i < buttons.length; i++) {
                console.log("Checking button:", buttons[i].innerText.toLowerCase());
                if (buttons[i].innerText.toLowerCase() === firstParam) {
                    console.log("Opening menu for:", firstParam);
                    buttons[i].parentElement.classList.add("app-vertical-nav__item--open");
                    buttons[i].setAttribute("aria-expanded", "true");
                    buttons[i].nextElementSibling.removeAttribute("hidden");
                }
            }

            // cycle through the list items and check if the href matches the second parameter and if it does then set it to active
            var items = document.getElementsByClassName("app-vertical-nav__link");
            for (var j = 0; j < items.length; j++) {
                console.log("Checking link:", items[j].href.toLowerCase());
                var itemHref = items[j].href.toLowerCase().split("/").pop().split("-").join(" ");
                if (itemHref === secondParam) {
                    console.log("Setting active for:", secondParam);
                    items[j].parentElement.classList.add("app-vertical-nav__item--active");
                }
            }
        }

        for (var i = 0; i < list.length; i++) {
            list[i].addEventListener("click", function () {
                console.log(this);
                console.log("Item clicked!");
                console.log(this.classList);
                this.classList.toggle("app-vertical-nav__item--open");
                console.log(this.children[0]);
                this.children[0].toggleAttribute("aria-expanded");
                this.children[1].toggleAttribute("hidden");
            });
        }
    });
</script>
